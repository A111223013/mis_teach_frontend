<div class="calendar-controls flex items-center gap-2 mb-4">
  <button (click)="prev()" class="px-3 py-1 bg-gray-200 rounded">上一個</button>
  <button (click)="goToday()" class="px-3 py-1 bg-gray-200 rounded">今天</button>
  <button (click)="next()" class="px-3 py-1 bg-gray-200 rounded">下一個</button>

  <select [(ngModel)]="view" class="ml-4 border rounded px-2 py-1">
    <option [ngValue]="CalendarView.Month">月視圖</option>
    <option [ngValue]="CalendarView.Week">週視圖</option>
    <option [ngValue]="CalendarView.Day">日視圖</option>
  </select>

  <button (click)="openAddModal(today)" class="ml-auto px-3 py-1 bg-blue-400 text-white rounded">
  新增代辦事項
</button>

</div>

<!-- 月/週/日視圖 -->
<mwl-calendar-month-view
  *ngIf="view === CalendarView.Month"
  [viewDate]="viewDate"
  [events]="events"
  (dayClicked)="openAddModal($event.day.date)"
  (eventClicked)="openEditModal($event.event)">
</mwl-calendar-month-view>

<mwl-calendar-week-view
  *ngIf="view === CalendarView.Week"
  [viewDate]="viewDate"
  [events]="events"
  (hourSegmentClicked)="openAddModal($event.date)"
  (eventClicked)="openEditModal($event.event)">
</mwl-calendar-week-view>

<mwl-calendar-day-view
  *ngIf="view === CalendarView.Day"
  [viewDate]="viewDate"
  [events]="events"
  (hourSegmentClicked)="openAddModal($event.date)"
  (eventClicked)="openEditModal($event.event)">
</mwl-calendar-day-view>

<!-- Modal -->
<div *ngIf="modalOpen" class="modal-backdrop">
  <div class="modal">
    <h3>{{ editingEvent ? '編輯備忘錄' : '新增備忘錄' }}</h3>

    <label>日期與時間:</label>
    <input type="text" mwlFlatpickr [(ngModel)]="selectedDate">

    <label>內容:</label>
    <input type="text" [(ngModel)]="eventTitle">

    <label>
      <input type="checkbox" [(ngModel)]="notify"> 啟用通知
    </label>

    <label *ngIf="notify">提醒時間:</label>
    <input *ngIf="notify" type="text" mwlFlatpickr [(ngModel)]="notifyTime">

    <div class="modal-buttons mt-2">
      <button (click)="saveEvent()" class="bg-green-400 px-3 py-1 rounded">儲存</button>
      <button *ngIf="editingEvent" (click)="deleteEvent()" class="bg-red-400 px-3 py-1 rounded">刪除</button>
      <button (click)="closeModal()" class="bg-gray-300 px-3 py-1 rounded">取消</button>
    </div>
  </div>
</div>
