<div class="news-container">
  <!-- 頁面標題 -->
  <div class="page-header">
    <h1 class="page-title">科技趨勢</h1>
    <p class="page-subtitle">掌握最新的資訊科技動態與趨勢</p>
  </div>

  <!-- 搜尋欄 -->
  <div class="search-container">
    <div class="search-wrapper">
      <div class="search-icon-wrapper">
        <svg cIcon name="cilMagnifyingGlass" class="search-icon"></svg>
      </div>
      <input 
        type="text" 
        [(ngModel)]="searchTerm" 
        placeholder="搜尋新聞標題、內容或標籤..."
        class="search-input"
        (keyup.enter)="onSearch()">
      @if (searchTerm) {
        <button class="clear-btn" (click)="clearSearch()" type="button" title="清除搜尋">
          <svg cIcon name="cilX"></svg>
        </button>
      }
      <button class="search-btn" (click)="onSearch()" type="button">
        搜尋
      </button>
    </div>
  </div>

  <!-- 載入指示器 -->
  @if (loading) {
    <div class="loading-container">
      <div class="loading-spinner">
        <div class="spinner"></div>
      </div>
      <p class="loading-text">載入新聞中...</p>
    </div>
  }

  <!-- 卡片容器 -->
  <div class="news-grid">
    @for (card of cards; track card.headline) {
      <a [href]="card.url" target="_blank" class="news-card-link" rel="noopener noreferrer">
        <article class="news-card">
          <!-- 卡片圖片/標頭 -->
          <div class="news-card-image">
            @if (card.headerType === 'image') {
              <img [src]="card.headerContent" [alt]="card.headline" class="card-image" 
                   onerror="this.onerror=null; this.src='data:image/svg+xml,%3Csvg xmlns=\'http://www.w3.org/2000/svg\' width=\'400\' height=\'250\'%3E%3Crect fill=\'%23f0f0f0\' width=\'400\' height=\'250\'/%3E%3Ctext fill=\'%23999\' font-family=\'sans-serif\' font-size=\'18\' x=\'50%25\' y=\'50%25\' text-anchor=\'middle\' dy=\'.3em\'%3E無圖片%3C/text%3E%3C/svg%3E';">
              <div class="image-overlay"></div>
            } @else {
              <div class="card-image-placeholder">
                <svg cIcon name="cilNewspaper" class="placeholder-icon"></svg>
              </div>
            }
            <!-- 標籤 -->
            @if (card.tags && card.tags.length > 0) {
              <div class="news-card-tags">
                @for (tag of card.tags.slice(0, 3); track tag.text) {
                  <span class="news-tag">{{ tag.text }}</span>
                }
              </div>
            }
          </div>
          
          <!-- 卡片內容 -->
          <div class="news-card-content">
            <h3 class="news-card-title">{{ card.headline }}</h3>
            <p class="news-card-summary">{{ card.subheadline }}</p>
          </div>
          
          <!-- 卡片底部 -->
          <div class="news-card-footer">
            <div class="news-meta">
              <svg cIcon name="cilCalendar" class="meta-icon"></svg>
              <time class="news-date">{{ card.date }}</time>
            </div>
            <div class="news-read-more">
              閱讀更多
              <svg cIcon name="cilArrowRight" class="arrow-icon"></svg>
            </div>
          </div>
        </article>
      </a>
    }
  </div>

  <!-- 分頁器 -->
  @if (!loading && cards.length > 0) {
    <div class="pagination-container">
      <nav aria-label="新聞分頁">
        <ul class="pagination justify-content-center mb-0">
          <!-- 上一頁按鈕 -->
          <li class="page-item" [class.disabled]="!hasPrev">
            <a class="page-link" (click)="goToPage(currentPage - 1)" [attr.aria-disabled]="!hasPrev" tabindex="-1">
              上一頁
            </a>
          </li>
          
          <!-- 頁碼按鈕 -->
          @for (page of getPageNumbers(); track page) {
            @if (page === '...') {
              <li class="page-item disabled">
                <span class="page-link">...</span>
              </li>
            } @else {
              <li class="page-item" [class.active]="page === currentPage">
                <a class="page-link" (click)="goToPage(page)">
                  {{ page }}
                </a>
              </li>
            }
          }
          
          <!-- 下一頁按鈕 -->
          <li class="page-item" [class.disabled]="!hasNext">
            <a class="page-link" (click)="goToPage(currentPage + 1)" [attr.aria-disabled]="!hasNext">
              下一頁
            </a>
          </li>
        </ul>
      </nav>
      
      <!-- 分頁資訊 -->
      <div class="pagination-info">
        顯示第 {{ (currentPage - 1) * perPage + 1 }} - {{ currentPage * perPage > totalItems ? totalItems : currentPage * perPage }} 條，
        共 {{ totalItems }} 條新聞
      </div>
    </div>
  }

  <!-- 無結果訊息 -->
  @if (!loading && cards.length === 0) {
    <div class="no-results">
      <p>沒有找到相關新聞</p>
    </div>
  }
</div>
