<div class="container-fluid" [class.sidebar-open]="sidebarVisible">
    <button class="btn btn-outline-secondary back-btn" (click)="goBack()">← 回上一頁</button>
    
    <!-- 螢光筆工具列 - 右側簡潔版 -->
    <div class="highlighter-sidebar" [class.active]="sidebarVisible">
        <div class="sidebar-content">
            <!-- 顏色選擇 -->
            <div class="color-section">
                <div class="color-palette">
                    <button 
                        *ngFor="let color of highlightColors" 
                        class="color-btn"
                        [class.active]="selectedColor === color.value"
                        [style.background-color]="color.value"
                        [title]="color.name"
                        (click)="selectColor(color.value)"
                    ></button>
                </div>
            </div>
            
            <!-- 功能按鈕 -->
            <div class="action-section">
                <button 
                    class="action-btn"
                    [class.active]="highlighterMode"
                    (click)="toggleHighlighterMode()"
                    title="{{ highlighterMode ? '關閉' : '開啟' }}螢光筆"
                >
                    <i class="cil-highlight"></i>
                </button>
                <button 
                    class="action-btn"
                    (click)="generateQuizFromToolbar()"
                    title="生成題目"
                >
                    <i class="cil-lightbulb"></i>
                </button>
                <button 
                    class="action-btn"
                    (click)="clearAllHighlights()"
                    title="清除所有劃記"
                >
                    <i class="cil-trash"></i>
                </button>
                <button 
                    class="action-btn"
                    (click)="exportHighlights()"
                    title="匯出劃記內容"
                >
                    <i class="cil-export"></i>
                </button>
            </div>
        </div>
    </div>
    <!-- 右側抽屜開關箭頭 -->
    <button 
      class="sidebar-toggle-btn"
      (click)="toggleSidebar()"
      [attr.aria-expanded]="sidebarVisible"
      title="顯示/收合螢光筆工具"
      [class.expanded]="sidebarVisible"
    >
      {{ sidebarVisible ? '‹' : '›' }}
    </button>
    
    <div class="row">
        <!-- TOC -->
        <div class="toc-wrapper" [class.collapsed]="tocCollapsed">
            <c-card>
                <h5>目錄</h5>
                <div id="toc-list"></div>
                <button class="btn btn-sm btn-outline-secondary mt-3" (click)="toggleTOC()">收合目錄</button>
            </c-card>
        </div>

        <!-- 內容 -->
        <div class="content-wrapper" [class.centered]="tocCollapsed">
            <div class="col-md-9 content p-4" id="content">
                <h2 class="text-center mb-4">{{ filename }}</h2>
                <div class="card shadow-lg p-4">
                    <markdown [data]="content" (ready)="onMarkdownReady()"></markdown>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- 浮動按鈕組 -->
<div 
  *ngIf="showButtons" 
  class="floating-buttons"
  [style.left.px]="buttonPosition.x"
  [style.top.px]="buttonPosition.y"
>
  <button 
    class="btn btn-primary btn-sm me-2" 
    (click)="askQuestion()"
    title="詢問關於選中的內容"
  >
    <i class="cil-question-mark"></i> 詢問
  </button>
  <button 
    class="btn btn-warning btn-sm" 
    (click)="highlightSelectedText()"
    title="劃記選中的文字"
  >
    <i class="cil-highlight"></i> 劃記
  </button>
</div>